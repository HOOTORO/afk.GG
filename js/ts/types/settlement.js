import { newEl } from "../components/helper.js";
import { AbExSellModifier, elTag, RelicBase } from "../model/constants.js";
import { IconizedInput } from "./iconized.js";
import { Tier } from "./tier.js";
export class Settlement extends IconizedInput {
    essencePerHour;
    yield;
    dropTier;
    dropTime;
    constructor(id, icon, name, essencePerHour, yld, dropTier, dropTime) {
        const hcls = "abex input town";
        super(id, icon, name);
        this.cssName = hcls;
        this.essencePerHour = essencePerHour;
        this.yield = yld;
        this.dropTier = dropTier;
        this.dropTime = dropTime;
        this.buttons = true;
        this.value = parseInt(this.init());
        this.width = 58;
        this.height = 30;
    }
    EPH() {
        return (this.value *
            (this.essencePerHour + (this.essencePerHour * this.yield) / 100));
    }
    RelicDrop() {
        return this.dropTime / this.value / 3600;
    }
    ConvertedDropEssValue(avgPrice, wantedQuantity) {
        const hitProbability = wantedQuantity / RelicBase;
        return ((avgPrice / this.RelicDrop()) * hitProbability +
            (((1 - hitProbability) * avgPrice) / this.RelicDrop()) * AbExSellModifier);
    }
    Tier() {
        return new Tier(this.dropTier);
    }
    htmlInfo() {
        const color = this.Tier().color();
        const el = newEl(elTag.Span, {
            style: `color: ${color}`,
        }, `${this.name} : [ ${this.RelicDrop().toPrecision(3)}h ]`);
        return el;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0dGxlbWVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy90eXBlcy9zZXR0bGVtZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNoRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzNFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDOUMsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUVqQyxNQUFNLE9BQU8sVUFBVyxTQUFRLGFBQWE7SUFDM0MsY0FBYyxDQUFTO0lBQ3ZCLEtBQUssQ0FBUztJQUNkLFFBQVEsQ0FBUztJQUNqQixRQUFRLENBQVM7SUFDakIsWUFDRSxFQUFVLEVBQ1YsSUFBWSxFQUNaLElBQVksRUFDWixjQUFzQixFQUN0QixHQUFXLEVBQ1gsUUFBZ0IsRUFDaEIsUUFBZ0I7UUFHaEIsTUFBTSxJQUFJLEdBQUcsaUJBQWlCLENBQUM7UUFFL0IsS0FBSyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDdEIsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7UUFDcEIsSUFBSSxDQUFDLGNBQWMsR0FBRyxjQUFjLENBQUM7UUFDckMsSUFBSSxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUM7UUFDakIsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDekIsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDekIsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7UUFDcEIsSUFBSSxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7UUFDbkMsSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7UUFDaEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUM7SUFDbkIsQ0FBQztJQUVNLEdBQUc7UUFDUixPQUFPLENBQ0wsSUFBSSxDQUFDLEtBQUs7WUFDVixDQUFDLElBQUksQ0FBQyxjQUFjLEdBQUcsQ0FBQyxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FDakUsQ0FBQztJQUNKLENBQUM7SUFDTSxTQUFTO1FBQ2QsT0FBTyxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO0lBQzNDLENBQUM7SUFFTSxxQkFBcUIsQ0FBQyxRQUFnQixFQUFFLGNBQXNCO1FBQ25FLE1BQU0sY0FBYyxHQUFHLGNBQWMsR0FBRyxTQUFTLENBQUM7UUFDbEQsT0FBTyxDQUNMLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQyxHQUFHLGNBQWM7WUFDOUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLGNBQWMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxHQUFHLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQyxHQUFHLGdCQUFnQixDQUMxRSxDQUFDO0lBQ0osQ0FBQztJQUVNLElBQUk7UUFDVCxPQUFPLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBRUQsUUFBUTtRQUNOLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNsQyxNQUFNLEVBQUUsR0FBRyxLQUFLLENBQ2QsS0FBSyxDQUFDLElBQUksRUFDVjtZQUNFLEtBQUssRUFBRSxVQUFVLEtBQUssRUFBRTtTQUN6QixFQUNELEdBQUcsSUFBSSxDQUFDLElBQUksUUFBUSxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQ3pELENBQUM7UUFDRixPQUFPLEVBQUUsQ0FBQztJQUNaLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG5ld0VsIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvaGVscGVyLmpzXCI7XG5pbXBvcnQgeyBBYkV4U2VsbE1vZGlmaWVyLCBlbFRhZywgUmVsaWNCYXNlIH0gZnJvbSBcIi4uL21vZGVsL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IHsgSWNvbml6ZWRJbnB1dCB9IGZyb20gXCIuL2ljb25pemVkLmpzXCI7XG5pbXBvcnQgeyBUaWVyIH0gZnJvbSBcIi4vdGllci5qc1wiO1xuXG5leHBvcnQgY2xhc3MgU2V0dGxlbWVudCBleHRlbmRzIEljb25pemVkSW5wdXQge1xuICBlc3NlbmNlUGVySG91cjogbnVtYmVyO1xuICB5aWVsZDogbnVtYmVyO1xuICBkcm9wVGllcjogbnVtYmVyO1xuICBkcm9wVGltZTogbnVtYmVyO1xuICBjb25zdHJ1Y3RvcihcbiAgICBpZDogbnVtYmVyLFxuICAgIGljb246IHN0cmluZyxcbiAgICBuYW1lOiBzdHJpbmcsXG4gICAgZXNzZW5jZVBlckhvdXI6IG51bWJlcixcbiAgICB5bGQ6IG51bWJlcixcbiAgICBkcm9wVGllcjogbnVtYmVyLFxuICAgIGRyb3BUaW1lOiBudW1iZXJcbiAgKSB7XG4gICAgLy8gY29uc3QgaGNscyA9IFwiXCI7XG4gICAgY29uc3QgaGNscyA9IFwiYWJleCBpbnB1dCB0b3duXCI7XG5cbiAgICBzdXBlcihpZCwgaWNvbiwgbmFtZSk7XG4gICAgdGhpcy5jc3NOYW1lID0gaGNscztcbiAgICB0aGlzLmVzc2VuY2VQZXJIb3VyID0gZXNzZW5jZVBlckhvdXI7XG4gICAgdGhpcy55aWVsZCA9IHlsZDtcbiAgICB0aGlzLmRyb3BUaWVyID0gZHJvcFRpZXI7XG4gICAgdGhpcy5kcm9wVGltZSA9IGRyb3BUaW1lO1xuICAgIHRoaXMuYnV0dG9ucyA9IHRydWU7XG4gICAgdGhpcy52YWx1ZSA9IHBhcnNlSW50KHRoaXMuaW5pdCgpKTtcbiAgICB0aGlzLndpZHRoID0gNTg7XG4gICAgdGhpcy5oZWlnaHQgPSAzMDtcbiAgfVxuXG4gIHB1YmxpYyBFUEgoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMudmFsdWUgKlxuICAgICAgKHRoaXMuZXNzZW5jZVBlckhvdXIgKyAodGhpcy5lc3NlbmNlUGVySG91ciAqIHRoaXMueWllbGQpIC8gMTAwKVxuICAgICk7XG4gIH1cbiAgcHVibGljIFJlbGljRHJvcCgpIHtcbiAgICByZXR1cm4gdGhpcy5kcm9wVGltZSAvIHRoaXMudmFsdWUgLyAzNjAwO1xuICB9XG5cbiAgcHVibGljIENvbnZlcnRlZERyb3BFc3NWYWx1ZShhdmdQcmljZTogbnVtYmVyLCB3YW50ZWRRdWFudGl0eTogbnVtYmVyKSB7XG4gICAgY29uc3QgaGl0UHJvYmFiaWxpdHkgPSB3YW50ZWRRdWFudGl0eSAvIFJlbGljQmFzZTtcbiAgICByZXR1cm4gKFxuICAgICAgKGF2Z1ByaWNlIC8gdGhpcy5SZWxpY0Ryb3AoKSkgKiBoaXRQcm9iYWJpbGl0eSArXG4gICAgICAoKCgxIC0gaGl0UHJvYmFiaWxpdHkpICogYXZnUHJpY2UpIC8gdGhpcy5SZWxpY0Ryb3AoKSkgKiBBYkV4U2VsbE1vZGlmaWVyXG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBUaWVyKCk6IFRpZXIge1xuICAgIHJldHVybiBuZXcgVGllcih0aGlzLmRyb3BUaWVyKTtcbiAgfVxuXG4gIGh0bWxJbmZvKCk6IEhUTUxFbGVtZW50IHtcbiAgICBjb25zdCBjb2xvciA9IHRoaXMuVGllcigpLmNvbG9yKCk7XG4gICAgY29uc3QgZWwgPSBuZXdFbChcbiAgICAgIGVsVGFnLlNwYW4sXG4gICAgICB7XG4gICAgICAgIHN0eWxlOiBgY29sb3I6ICR7Y29sb3J9YCxcbiAgICAgIH0sXG4gICAgICBgJHt0aGlzLm5hbWV9IDogWyAke3RoaXMuUmVsaWNEcm9wKCkudG9QcmVjaXNpb24oMyl9aCBdYFxuICAgICk7XG4gICAgcmV0dXJuIGVsO1xuICB9XG59XG4iXX0=