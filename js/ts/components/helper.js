import { elProp, elTag, verb } from "../model/constants.js";
export const log = (x) => {
    if (verb) {
        console.log(x);
    }
};
export function newIn(fieldType, attrs) {
    attrs["type"] = fieldType;
    return newEl("input", { ...attrs });
}
export function newEl(tag, props, inner) {
    const doc = document.createElement(tag);
    if (props) {
        Object.entries(props).forEach((k) => {
            if (k[1] != undefined) {
                doc.setAttribute(k[0], k[1]);
            }
        });
    }
    if (inner) {
        doc.innerHTML = inner;
    }
    return doc;
}
export function newBtn(text, c, id) {
    let attrs = {};
    attrs[elProp.Type] = "button";
    if (c) {
        attrs[elProp.Class] = c;
    }
    if (id) {
        attrs[elProp.Id] = id;
    }
    return newEl(elTag.Button, attrs, text);
}
export function buttonWrapInput(el, update) {
    let input = el;
    const wrap = newEl("div", { class: "number-input" }), incBtn = newBtn("<", `desc ${el.className}`), descBtn = newBtn(">", `inc ${el.className}`);
    wrap.appendChild(incBtn);
    wrap.appendChild(el);
    wrap.appendChild(descBtn);
    wrap.addEventListener("click", (e) => {
        e.preventDefault();
        if (e.target instanceof HTMLButtonElement) {
            if (e.target.className.includes("desc")) {
                if (input.valueAsNumber > 0) {
                    input.stepDown();
                }
            }
            else {
                input.stepUp();
            }
            update(input.valueAsNumber);
        }
    });
    return wrap;
}
export function storedValue(inputId, value) {
    if (value >= 0 || value) {
        try {
            const str = JSON.stringify(value);
            localStorage.setItem(inputId, str);
        }
        catch (e) {
            console.log(`save error ${e}`);
            return false;
        }
        return true;
    }
    const v = localStorage.getItem(inputId);
    return v ? v : false;
}
export function savedObj(str, def) {
    if (storedValue(str)) {
        return Object.assign(def, JSON.parse(storedValue(str).toString()));
    }
    return def;
}
export async function fetchData(assetsPath) {
    const data = await fetch(`/assets/${assetsPath}`);
    const str = await data.text();
    return JSON.parse(str);
}
export function safeSum(n) {
    if (n.length > 0 && !hasEmpty(n)) {
        return n.reduce((a, b) => a + b, 0);
    }
    else {
        return 0;
    }
}
function hasEmpty(obj) {
    return (Object.keys(obj).length === 0 &&
        Object.values(obj).some((x) => x === null || x === 0 || x === undefined));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvaGVscGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFTLElBQUksRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBR25FLE1BQU0sQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQU0sRUFBRSxFQUFFO0lBQzVCLElBQUksSUFBSSxFQUFFLENBQUM7UUFDVCxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2pCLENBQUM7QUFDSCxDQUFDLENBQUM7QUFNRixNQUFNLFVBQVUsS0FBSyxDQUFDLFNBQWdCLEVBQUUsS0FBK0I7SUFDckUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFHLFNBQVMsQ0FBQztJQUMxQixPQUFPLEtBQUssQ0FBQyxPQUFPLEVBQUUsRUFBRSxHQUFHLEtBQUssRUFBRSxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQUVELE1BQU0sVUFBVSxLQUFLLENBQ25CLEdBQVcsRUFDWCxLQUErQixFQUMvQixLQUFjO0lBRWQsTUFBTSxHQUFHLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN4QyxJQUFJLEtBQUssRUFBRSxDQUFDO1FBQ1YsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtZQUNsQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxTQUFTLEVBQUUsQ0FBQztnQkFDdEIsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDL0IsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUNELElBQUksS0FBSyxFQUFFLENBQUM7UUFDVixHQUFHLENB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QUFLLENBQUMsSUFBSSxDQUFDLEtBQUssU0FBUyxDQUFDLENBQ3pFLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZWxQcm9wLCBlbFRhZywgSW5wdXQsIHZlcmIgfSBmcm9tIFwiLi4vbW9kZWwvY29uc3RhbnRzLmpzXCI7XG4vLyBpbXBvcnQgc2FuaXRpemVIdG1sIGZyb20gXCJcIjtcblxuZXhwb3J0IGNvbnN0IGxvZyA9ICh4OiBhbnkpID0+IHtcbiAgaWYgKHZlcmIpIHtcbiAgICBjb25zb2xlLmxvZyh4KTtcbiAgfVxufTtcblxuLy8hIC8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vISBIVE1MIEdlbmVyYXRvcnMgLy9cbi8vISAvLy8vLy8vLy8vLy8vLy8vL1xuXG5leHBvcnQgZnVuY3Rpb24gbmV3SW4oZmllbGRUeXBlOiBJbnB1dCwgYXR0cnM/OiB7IFtrOiBzdHJpbmddOiBzdHJpbmcgfSkge1xuICBhdHRyc1tcInR5cGVcIl0gPSBmaWVsZFR5cGU7XG4gIHJldHVybiBuZXdFbChcImlucHV0XCIsIHsgLi4uYXR0cnMgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBuZXdFbChcbiAgdGFnOiBzdHJpbmcsXG4gIHByb3BzPzogeyBbazogc3RyaW5nXTogc3RyaW5nIH0sXG4gIGlubmVyPzogc3RyaW5nXG4pIHtcbiAgY29uc3QgZG9jID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xuICBpZiAocHJvcHMpIHtcbiAgICBPYmplY3QuZW50cmllcyhwcm9wcykuZm9yRWFjaCgoaykgPT4ge1xuICAgICAgaWYgKGtbMV0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGRvYy5zZXRBdHRyaWJ1dGUoa1swXSwga1sxXSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgaWYgKGlubmVyKSB7XG4gICAgZG9jLmlubmVySFRNTCA9IGlubmVyO1xuICB9XG4gIHJldHVybiBkb2M7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBuZXdCdG4odGV4dD86IHN0cmluZywgYz86IHN0cmluZywgaWQ/OiBzdHJpbmcpIHtcbiAgbGV0IGF0dHJzOiB7IFt4OiBzdHJpbmddOiBzdHJpbmcgfSA9IHt9O1xuICBhdHRyc1tlbFByb3AuVHlwZV0gPSBcImJ1dHRvblwiO1xuICBpZiAoYykge1xuICAgIGF0dHJzW2VsUHJvcC5DbGFzc10gPSBjO1xuICB9XG4gIGlmIChpZCkge1xuICAgIGF0dHJzW2VsUHJvcC5JZF0gPSBpZDtcbiAgfVxuICByZXR1cm4gbmV3RWwoZWxUYWcuQnV0dG9uLCBhdHRycywgdGV4dCk7XG59XG5leHBvcnQgZnVuY3Rpb24gYnV0dG9uV3JhcElucHV0KGVsOiBIVE1MRWxlbWVudCwgdXBkYXRlOiAoeTogbnVtYmVyKSA9PiB2b2lkKSB7XG4gIGxldCBpbnB1dCA9IGVsIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gIGNvbnN0IHdyYXAgPSBuZXdFbChcImRpdlwiLCB7IGNsYXNzOiBcIm51bWJlci1pbnB1dFwiIH0pLFxuICAgIC8vIGluY0J0biA9IG5ld0J0bihcIuKXgO+4j1wiLCBgZGVzYyAke2VsLmNsYXNzTmFtZX1gKSxcbiAgICBpbmNCdG4gPSBuZXdCdG4oXCI8XCIsIGBkZXNjICR7ZWwuY2xhc3NOYW1lfWApLFxuICAgIC8vIGRlc2NCdG4gPSBuZXdCdG4oXCLilrbvuI9cIiwgYGluYyAke2VsLmNsYXNzTmFtZX1gKTtcbiAgICBkZXNjQnRuID0gbmV3QnRuKFwiPlwiLCBgaW5jICR7ZWwuY2xhc3NOYW1lfWApO1xuXG4gIHdyYXAuYXBwZW5kQ2hpbGQoaW5jQnRuKTtcbiAgd3JhcC5hcHBlbmRDaGlsZChlbCk7XG4gIHdyYXAuYXBwZW5kQ2hpbGQoZGVzY0J0bik7XG4gIHdyYXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGlmIChlLnRhcmdldCBpbnN0YW5jZW9mIEhUTUxCdXR0b25FbGVtZW50KSB7XG4gICAgICBpZiAoZS50YXJnZXQuY2xhc3NOYW1lLmluY2x1ZGVzKFwiZGVzY1wiKSkge1xuICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciA+IDApIHtcbiAgICAgICAgICBpbnB1dC5zdGVwRG93bigpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbnB1dC5zdGVwVXAoKTtcbiAgICAgIH1cbiAgICAgIHVwZGF0ZShpbnB1dC52YWx1ZUFzTnVtYmVyKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB3cmFwO1xufVxuXG4vLyEgLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8hIC8vLyBsb2NhbCBkYXRhIC8vL1xuLy8hIC8vLy8vLy8vLy8vLy8vLy8vXG5leHBvcnQgZnVuY3Rpb24gc3RvcmVkVmFsdWUoaW5wdXRJZDogc3RyaW5nLCB2YWx1ZT86IGFueSk6IGJvb2xlYW4gfCBzdHJpbmcge1xuICBpZiAodmFsdWUgPj0gMCB8fCB2YWx1ZSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdHIgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShpbnB1dElkLCBzdHIpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBzYXZlIGVycm9yICR7ZX1gKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgY29uc3QgdiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGlucHV0SWQpO1xuICByZXR1cm4gdiA/IHYgOiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhdmVkT2JqPFR5cGU+KHN0cjogc3RyaW5nLCBkZWY6IFR5cGUpIHtcbiAgaWYgKHN0b3JlZFZhbHVlKHN0cikpIHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihkZWYsIEpTT04ucGFyc2Uoc3RvcmVkVmFsdWUoc3RyKS50b1N0cmluZygpKSk7XG4gIH1cbiAgcmV0dXJuIGRlZjtcbn1cblxuLy8hIC8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vISAvLyB1dGlsaXR5IGZ1bmMgLy9cbi8vISAvLy8vLy8vLy8vLy8vLy8vL1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hEYXRhKGFzc2V0c1BhdGg6IHN0cmluZykge1xuICBjb25zdCBkYXRhID0gYXdhaXQgZmV0Y2goYC9hc3NldHMvJHthc3NldHNQYXRofWApO1xuICBjb25zdCBzdHIgPSBhd2FpdCBkYXRhLnRleHQoKTtcbiAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhZmVTdW0objogbnVtYmVyW10pIHtcbiAgaWYgKG4ubGVuZ3RoID4gMCAmJiAhaGFzRW1wdHkobikpIHtcbiAgICByZXR1cm4gbi5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gMDtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYXNFbXB0eShvYmo6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBib29sZWFuIHtcbiAgcmV0dXJuIChcbiAgICBPYmplY3Qua2V5cyhvYmopLmxlbmd0aCA9PT0gMCAmJlxuICAgIE9iamVjdC52YWx1ZXMob2JqKS5zb21lKCh4KSA9PiB4ID09PSBudWxsIHx8IHggPT09IDAgfHwgeCA9PT0gdW5kZWZpbmVkKVxuICApO1xufVxuIl19