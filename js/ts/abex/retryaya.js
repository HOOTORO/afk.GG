import { expeditor } from "../abex.js";
import { elBuilder } from "../components/builder.js";
import { Boss, elTag, Input, AbEx } from "../model/constants.js";
export function foodRemain() {
    const app = document.getElementById("rem-food");
    if (!app) {
        console.log(`no app tag, return`);
    }
    else {
        initForm(app);
        window.onload = updateAbex;
        app.addEventListener("input", (e) => {
            if (e.target instanceof HTMLInputElement) {
                inputChange(e.target);
                updateAbex();
            }
        });
    }
}
function updateAbex() {
    let totalFood = expeditor.SilentStam();
    let atl = totalFood / Boss.foodCost;
    let rtyLeft = (totalFood % Boss.foodCost) / Boss.retry;
    document.getElementById("total-food").innerText =
        Math.floor(totalFood).toString();
    document.getElementById("attack-left").innerText = Math.floor(atl).toString();
    document.getElementById("retry-lim").innerText = rtyLeft.toFixed(1);
}
function initForm(n) {
    const form = new elBuilder(elTag.Form, { class: "team-set-inputs" })
        .add(elTag.Input, { type: Input.Datetime, id: "abex-date" }, "Season start")
        .add(expeditor.stamina.html())
        .add(expeditor.guild.specs.html())
        .add(expeditor.star.html())
        .html(), out = new elBuilder(elTag.Div, { class: "outbox" })
        .add(elTag.Span, { id: `total-food` }, "Food")
        .add(elTag.Span, { id: `attack-left` }, "Left")
        .add(elTag.Span, { id: `retry-lim` }, "Retries")
        .html();
    n.appendChild(form);
    n.appendChild(out);
}
function inputChange(e) {
    if (e.type === "datetime-local") {
        AbEx.startD = e.valueAsDate;
    }
    else {
        e.setAttribute("value", e.value);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmV0cnlheWEuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvYWJleC9yZXRyeWF5YS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUNyRCxPQUFPLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFFakUsTUFBTSxVQUFVLFVBQVU7SUFDeEIsTUFBTSxHQUFHLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUNoRCxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDVCxPQUFPLENBQUMsR0FBRyxDQUFDLG9CQUFvQixDQUFDLENBQUM7SUFDcEMsQ0FBQztTQUFNLENBQUM7UUFDTixRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDZCxNQUFNLENBQUMsTUFBTSxHQUFHLFVBQVUsQ0FBQztRQUUzQixHQUFHLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUU7WUFDbEMsSUFBSSxDQUFDLENBQUMsTUFBTSxZQUFZLGdCQUFnQixFQUFFLENBQUM7Z0JBQ3pDLFdBQVcsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ3RCLFVBQVUsRUFBRSxDQUFDO1lBQ2YsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztBQUNILENBQUM7QUFDRCxTQUFTLFVBQVU7SUFFakIsSUFBSSxTQUFTLEdBQUcsU0FBUyxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQ3ZDLElBQUksR0FBRyxHQUFHLFNBQVMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO0lBQ3BDLElBQUksT0FBTyxHQUFHLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBRXZELFFBQVEsQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUFDLENBQUMsU0FBUztRQUM3QyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ25DLFFBQVEsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDOUUsUUFBUSxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUN0RSxDQUFDO0FBRUQsU0FBUyxRQUFRLENBQUMsQ0FBYztJQUM5QixNQUFNLElBQUksR0FBRyxJQUFJLFNBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLEVBQUUsS0FBSyxFQUFFLGlCQUFpQixFQUFFLENBQUM7U0FDL0QsR0FBRyxDQUNGLEtBQUssQ0FBQyxLQUFLLEVBQ1gsRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLFFBQVEsRUFBRSxFQUFFLEVBQUUsV0FBVyxFQUFFLEVBQ3pDLGNBQWMsQ0FDZjtTQUNBLEdBQUcsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDO1NBQzdCLEdBQUcsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUNqQyxHQUFHLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUMxQixJQUFJLEVBQUUsRUFDVCxHQUFHLEdBQUcsSUFBSSxTQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsQ0FBQztTQUNoRCxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxFQUFFLEVBQUUsRUFBRSxZQUFZLEVBQUUsRUFBRSxNQUFNLENBQUM7U0FDN0MsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsRUFBRSxFQUFFLEVBQUUsYUFBYSxFQUFFLEVBQUUsTUFBTSxDQUFDO1NBQzlDLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLEVBQUUsRUFBRSxFQUFFLFdBQVcsRUFBRSxFQUFFLFNBQVMsQ0FBQztTQUMvQyxJQUFJLEVBQUUsQ0FBQztJQUdaLENBQUMsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEIsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNyQixDQUFDO0FBRUQsU0FBUyxXQUFXLENBQUMsQ0FBbUI7SUFDdEMsSUFBSSxDQUFDLENBQUMsSUFBSSxLQUFLLGdCQUFnQixFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsV0FBVyxDQUFDO0lBQzlCLENBQUM7U0FBTSxDQUFDO1FBQ04sQ0FBQyxDQUFDLFlBQVksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ25DLENBQUM7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXhwZWRpdG9yIH0gZnJvbSBcIi4uL2FiZXguanNcIjtcbmltcG9ydCB7IGVsQnVpbGRlciB9IGZyb20gXCIuLi9jb21wb25lbnRzL2J1aWxkZXIuanNcIjtcbmltcG9ydCB7IEJvc3MsIGVsVGFnLCBJbnB1dCwgQWJFeCB9IGZyb20gXCIuLi9tb2RlbC9jb25zdGFudHMuanNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGZvb2RSZW1haW4oKSB7XG4gIGNvbnN0IGFwcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVtLWZvb2RcIik7XG4gIGlmICghYXBwKSB7XG4gICAgY29uc29sZS5sb2coYG5vIGFwcCB0YWcsIHJldHVybmApO1xuICB9IGVsc2Uge1xuICAgIGluaXRGb3JtKGFwcCk7XG4gICAgd2luZG93Lm9ubG9hZCA9IHVwZGF0ZUFiZXg7XG5cbiAgICBhcHAuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICBpZiAoZS50YXJnZXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGlucHV0Q2hhbmdlKGUudGFyZ2V0KTtcbiAgICAgICAgdXBkYXRlQWJleCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5mdW5jdGlvbiB1cGRhdGVBYmV4KCkge1xuICAvLyBjYWxjdWxhdGlvbnNcbiAgbGV0IHRvdGFsRm9vZCA9IGV4cGVkaXRvci5TaWxlbnRTdGFtKCk7XG4gIGxldCBhdGwgPSB0b3RhbEZvb2QgLyBCb3NzLmZvb2RDb3N0O1xuICBsZXQgcnR5TGVmdCA9ICh0b3RhbEZvb2QgJSBCb3NzLmZvb2RDb3N0KSAvIEJvc3MucmV0cnk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b3RhbC1mb29kXCIpLmlubmVyVGV4dCA9XG4gICAgTWF0aC5mbG9vcih0b3RhbEZvb2QpLnRvU3RyaW5nKCk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXR0YWNrLWxlZnRcIikuaW5uZXJUZXh0ID0gTWF0aC5mbG9vcihhdGwpLnRvU3RyaW5nKCk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmV0cnktbGltXCIpLmlubmVyVGV4dCA9IHJ0eUxlZnQudG9GaXhlZCgxKTtcbn1cblxuZnVuY3Rpb24gaW5pdEZvcm0objogSFRNTEVsZW1lbnQpIHtcbiAgY29uc3QgZm9ybSA9IG5ldyBlbEJ1aWxkZXIoZWxUYWcuRm9ybSwgeyBjbGFzczogXCJ0ZWFtLXNldC1pbnB1dHNcIiB9KSAvL2lkOiBcImFiZXgtZm9ybVwiLFxuICAgICAgLmFkZChcbiAgICAgICAgZWxUYWcuSW5wdXQsXG4gICAgICAgIHsgdHlwZTogSW5wdXQuRGF0ZXRpbWUsIGlkOiBcImFiZXgtZGF0ZVwiIH0sXG4gICAgICAgIFwiU2Vhc29uIHN0YXJ0XCJcbiAgICAgIClcbiAgICAgIC5hZGQoZXhwZWRpdG9yLnN0YW1pbmEuaHRtbCgpKVxuICAgICAgLmFkZChleHBlZGl0b3IuZ3VpbGQuc3BlY3MuaHRtbCgpKVxuICAgICAgLmFkZChleHBlZGl0b3Iuc3Rhci5odG1sKCkpXG4gICAgICAuaHRtbCgpLFxuICAgIG91dCA9IG5ldyBlbEJ1aWxkZXIoZWxUYWcuRGl2LCB7IGNsYXNzOiBcIm91dGJveFwiIH0pXG4gICAgICAuYWRkKGVsVGFnLlNwYW4sIHsgaWQ6IGB0b3RhbC1mb29kYCB9LCBcIkZvb2RcIilcbiAgICAgIC5hZGQoZWxUYWcuU3BhbiwgeyBpZDogYGF0dGFjay1sZWZ0YCB9LCBcIkxlZnRcIilcbiAgICAgIC5hZGQoZWxUYWcuU3BhbiwgeyBpZDogYHJldHJ5LWxpbWAgfSwgXCJSZXRyaWVzXCIpXG4gICAgICAuaHRtbCgpO1xuXG4gIC8vIGNvbnN0IG91dHB1dEZpZWxkcyA9IFtcIlRvdGFsIEZvb2RcIiwgXCJBdHRhY2tzIGxlZnRcIiwgXCJSZXRyeSBCcmVha3BvaW50XCJdXG4gIG4uYXBwZW5kQ2hpbGQoZm9ybSk7XG4gIG4uYXBwZW5kQ2hpbGQob3V0KTtcbn1cblxuZnVuY3Rpb24gaW5wdXRDaGFuZ2UoZTogSFRNTElucHV0RWxlbWVudCkge1xuICBpZiAoZS50eXBlID09PSBcImRhdGV0aW1lLWxvY2FsXCIpIHtcbiAgICBBYkV4LnN0YXJ0RCA9IGUudmFsdWVBc0RhdGU7XG4gIH0gZWxzZSB7XG4gICAgZS5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLCBlLnZhbHVlKTtcbiAgfVxufVxuIl19